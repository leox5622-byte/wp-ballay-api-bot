{
  "meta": {
    "project": "WhatsApp Bot V2",
    "date": "2025-09-05",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "WhatsApp Bot V2 is an advanced modular WhatsApp bot built with Node.js, providing command handling, a web dashboard, multi-device support, and cloud deployment readiness. It offers users and admins rich features for managing WhatsApp interactions, groups, and bot configurations via an extensible command system and real-time web interfaces.",
  "core_goals": [
    "Provide a modular and extensible WhatsApp bot platform supporting user and admin commands.",
    "Offer a built-in web dashboard for real-time bot status, logs, QR authentication and administrative control.",
    "Enable secure, role-based access control for bot management and command execution.",
    "Support smooth deployment on cloud platforms with environment-based configuration.",
    "Ensure reliability with auto-restart, rate limiting, and graceful error handling."
  ],
  "key_features": [
    "Modular command system allowing dynamic addition of new commands and events.",
    "WebDashboard Status API offering real-time bot health and runtime status information.",
    "Dashboard Admin API with secure login, bot control endpoints, logs access, and command overview.",
    "Role-based permissions for commands to differentiate user, admin, and owner capabilities.",
    "Multi-device and WhatsApp Web API integration using Baileys for seamless messaging.",
    "Rate limiting to prevent abuse and ensure stable bot operation.",
    "Auto-restart functionality to maintain uptime and recover from failures.",
    "Comprehensive logging with paginated log retrieval via API.",
    "Easy deployment scripts and instructions for Render, Heroku, and VPS servers.",
    "Support for environment variables and config files for flexible setup and security."
  ],
  "user_flow_summary": [
    "User connects WhatsApp account via QR code scanned on the dashboard or CLI, establishing authentication with WhatsApp Web API.",
    "Users send commands via WhatsApp, which are parsed by the bot and responded to based on command permissions and logic.",
    "Admins log into the dashboard with password-based authentication for enhanced control and monitoring.",
    "Admins view bot status, command usage, and live logs through dashboard UI or API endpoints.",
    "Admins execute administrative commands like restart, eval, or system commands through either WhatsApp or dashboard APIs.",
    "The bot runs scheduled tasks and handles events asynchronously, maintaining persistent connectivity and state.",
    "Developers add commands or event handlers by creating files and restarting the bot to load new features."
  ],
  "validation_criteria": [
    "The bot successfully connects to WhatsApp and maintains authenticated sessions with QR code overhead minimal errors.",
    "Commands execute correctly according to roles and return appropriate responses without crashes.",
    "Dashboard APIs respond with accurate status, logs, and bot information within acceptable latency.",
    "Admin authentication enforces session management and restricts sensitive API access.",
    "Rate limiting mechanisms prevent excess command usage or request flooding effectively.",
    "Auto-restart triggers on failure conditions and successfully restores bot operation.",
    "Deployment scripts complete without errors and environment variable configurations are respected.",
    "Logs are properly stored, paginated, and retrievable from the dashboard API.",
    "Security best practices are verified including no sensitive data in repos and safe input handling."
  ],
  "code_summary": {
    "tech_stack": [
      "Node.js",
      "JavaScript",
      "@whiskeysockets/baileys",
      "Express.js",
      "Socket.IO",
      "MongoDB/Mongoose",
      "SQLite3",
      "Canvas",
      "Axios",
      "PM2"
    ],
    "features": [
      {
        "name": "WhatsApp Bot Core",
        "description": "Main WhatsApp bot functionality with QR code authentication and message handling",
        "files": [
          "index.js",
          "scripts/baileysCompat.js",
          "scripts/cmdloadder.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "WhatsApp Bot Core API",
            "version": "1.2.0"
          },
          "paths": {
            "/connect": {
              "post": {
                "summary": "Connect to WhatsApp",
                "description": "Establishes WhatsApp connection and generates QR code"
              }
            }
          }
        }
      },
      {
        "name": "Command System",
        "description": "Modular command system with dynamic loading and role-based access",
        "files": [
          "commands/*.js",
          "scripts/cmdloadder.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Command System API",
            "version": "1.0.0"
          },
          "paths": {
            "/commands/load": {
              "post": {
                "summary": "Load command module",
                "description": "Dynamically loads a command module"
              }
            },
            "/commands/unload": {
              "post": {
                "summary": "Unload command module",
                "description": "Unloads a command module"
              }
            }
          }
        }
      },
      {
        "name": "Utility Commands",
        "description": "Basic utility commands like ping, help, translate, weather",
        "files": [
          "commands/ping.js",
          "commands/help.js",
          "commands/translate.js",
          "commands/weather.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Utility Commands API",
            "version": "1.0.0"
          },
          "paths": {
            "/ping": {
              "get": {
                "summary": "Test bot responsiveness",
                "description": "Returns pong with latency information"
              }
            },
            "/translate": {
              "post": {
                "summary": "Translate text",
                "description": "Translates text between languages"
              }
            },
            "/weather": {
              "get": {
                "summary": "Get weather information",
                "description": "Returns weather forecast for specified location"
              }
            }
          }
        }
      },
      {
        "name": "Admin Management",
        "description": "Bot administration features including user roles and permissions",
        "files": [
          "commands/admin.js",
          "commands/kick.js",
          "commands/warn.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Admin Management API",
            "version": "1.0.0"
          },
          "paths": {
            "/admin/add": {
              "post": {
                "summary": "Add bot admin",
                "description": "Grants admin privileges to a user"
              }
            },
            "/admin/remove": {
              "post": {
                "summary": "Remove bot admin",
                "description": "Revokes admin privileges from a user"
              }
            }
          }
        }
      },
      {
        "name": "Entertainment Commands",
        "description": "Fun and entertainment features like games, memes, and interactive content",
        "files": [
          "commands/joke.js",
          "commands/quiz.js",
          "commands/rps.js",
          "commands/coinflip.js",
          "commands/slot.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Entertainment API",
            "version": "1.0.0"
          },
          "paths": {
            "/games/rps": {
              "post": {
                "summary": "Rock Paper Scissors game",
                "description": "Play rock paper scissors with the bot"
              }
            },
            "/games/quiz": {
              "get": {
                "summary": "Quiz game",
                "description": "Start a quiz game session"
              }
            }
          }
        }
      },
      {
        "name": "Media Processing",
        "description": "Image and media manipulation features using Canvas and image processing",
        "files": [
          "commands/avatar.js",
          "commands/jail.js",
          "commands/00_arrest.js",
          "scripts/messageMedia.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Media Processing API",
            "version": "1.0.0"
          },
          "paths": {
            "/media/avatar": {
              "post": {
                "summary": "Generate avatar",
                "description": "Creates custom avatar images"
              }
            },
            "/media/process": {
              "post": {
                "summary": "Process media",
                "description": "Applies effects to images and media"
              }
            }
          }
        }
      },
      {
        "name": "Economy System",
        "description": "Virtual economy with balance, banking, and ranking features",
        "files": [
          "commands/bal.js",
          "commands/bank.js",
          "commands/daily.js",
          "commands/work.js",
          "commands/rank.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Economy System API",
            "version": "1.0.0"
          },
          "paths": {
            "/economy/balance": {
              "get": {
                "summary": "Get user balance",
                "description": "Returns user's current balance"
              }
            },
            "/economy/daily": {
              "post": {
                "summary": "Claim daily reward",
                "description": "Claims daily currency reward"
              }
            }
          }
        }
      },
      {
        "name": "Web Dashboard",
        "description": "Web-based dashboard for bot management and monitoring",
        "files": [
          "dashboard/server.js",
          "tmp/run-dashboard.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Web Dashboard API",
            "version": "1.0.0"
          },
          "paths": {
            "/dashboard": {
              "get": {
                "summary": "Dashboard interface",
                "description": "Web interface for bot management"
              }
            },
            "/api/status": {
              "get": {
                "summary": "Bot status",
                "description": "Returns current bot status and statistics"
              }
            }
          }
        }
      },
      {
        "name": "Database Management",
        "description": "User data, chat settings, and persistent storage management",
        "files": [
          "models/User.js",
          "models/Group.js",
          "scripts/helpers.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Database API",
            "version": "1.0.0"
          },
          "paths": {
            "/db/users": {
              "get": {
                "summary": "Get user data",
                "description": "Retrieves user information from database"
              }
            },
            "/db/groups": {
              "get": {
                "summary": "Get group data",
                "description": "Retrieves group information from database"
              }
            }
          }
        }
      },
      {
        "name": "Event System",
        "description": "Event handling for welcome messages, leave notifications, and group events",
        "files": [
          "events/welcome.js",
          "events/leave.js",
          "events/message.js"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Event System API",
            "version": "1.0.0"
          },
          "paths": {
            "/events/welcome": {
              "post": {
                "summary": "Handle welcome events",
                "description": "Processes new member welcome messages"
              }
            },
            "/events/leave": {
              "post": {
                "summary": "Handle leave events",
                "description": "Processes member leave notifications"
              }
            }
          }
        }
      }
    ]
  }
}
